OfficeUI.factory("OfficeUIRibbonControlService",["$rootScope","$http","$q","ImagePreloaderService",function(i,h,f,e){var d={};const c="OfficeUIRibbon_SelectedTab";var a;var b;var g=[];d.SetLoadingMessage=function(j){j.LoadingMessage="Office Web Controls Ribbon Control Initialization"};d.Initialize=function(j){var k=f.defer();h.get(j).then(function(m){if(typeof m.data.Configuration==="undefined"||m.data.Configuration==""){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' does not contain a 'Configuration' property.")}if(typeof m.data.Tabs==="undefined"||m.data.Tabs==""){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' does not contain a 'Tabs' property.")}if(typeof m.data.ContextualGroups==="undefined"||m.data.ContextualGroups==""){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' does not contain a 'ContextualGroups' property.")}if(m.data.Tabs.length<2){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' must contain at least 2 tabs.")}a=m.data.Configuration[0].PreserveSelectedRibbonTab=="True";i.Tabs=m.data.Tabs;i.ContextualGroups=m.data.ContextualGroups;if(a){var o=OfficeUICore.StateManagement.GetCookie(c);if(o==""){d.setActiveTab(i.Tabs[1].Id)}else{d.setActiveTab(o)}}else{d.setActiveTab(i.Tabs[1].Id)}var l=JSPath.apply(".Groups.Areas.Actions.Resource",i.Tabs);l.concat(JSPath.apply(".Tabs.Groups.Areas.Actions.Resource",i.ContextualGroups));var n=[];$(l).each(function(p,q){n.push(e.Load(q))});f.all(n).then(function(){k.resolve()})});return k.promise};d.isTabActive=function(j){return b==j};d.setActiveTab=function(j){var k=JSON.parse(JSON.stringify(i.Tabs)).splice(1,i.Tabs.length-1);var m=false;var l=$.grep(k,function(n){return n.Id==j});if(l.length>0){m=true}$.each(i.ContextualGroups,function(n,o){if(d.isContextualGroupActive(o.Id)){$.each(o.Tabs,function(q,p){k.push(p)})}});l=$.grep(k,function(n){return n.Id==j});if(l.length==0){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.setActiveTab] - The tab '"+j+"' cannot be activated. Either the tab does not exists, or the tab belongs to a contextual group which isn't active.")}else{if(a&&m){OfficeUICore.StateManagement.SetCookie(c,j,365)}b=j}};d.setActiveTabColor=function(k){var j=k[0];var l=k[1];if(b==j){return l}};d.isContextualGroupActive=function(j){var k=$.grep(g,function(l){return l==j});return k.length==1};d.activateContextualGroup=function(j){if(!d.isContextualGroupActive(j)){g.push(j)}};d.deactivateContextualGroup=function(k){if(d.isContextualGroupActive(k)){var j=$.grep(i.ContextualGroups,function(m){return m.Id==k});var l=$.grep(j[0].Tabs,function(m){return m.Id==b});if(l.length>0){d.setActiveTab(i.Tabs[1].Id)}g=$.grep(g,function(m){return m!=k})}};d.areContextualGroupsActive=function(){return g.length>0};d.DisableIcon=function(k){var j=JSPath.apply('.Groups.Areas.Actions{.Id == "'+k+'"}',i.Tabs);if(j.length==0){OfficeUICore.Exceptions.OfficeUIElementNotFoundException("[OfficeUIRibbonControlService.DisableIcon] - An icon with id '"+k+"' cannot be found.")}j[0].Disabled="True"};d.EnableIcon=function(k){var j=JSPath.apply('.Groups.Areas.Actions{.Id == "'+k+'"}',i.Tabs);if(j.length==0){OfficeUICore.Exceptions.OfficeUIElementNotFoundException("[OfficeUIRibbonControlService.EnableIcon] - An icon with id '"+k+"' cannot be found.")}j[0].Disabled="False"};return d}]);