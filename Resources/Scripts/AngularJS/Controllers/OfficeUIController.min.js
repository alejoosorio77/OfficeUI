OfficeUI.controller("OfficeUIController",function(d,e,f,o,k,n,g){var b={};o.isInitialized=false;o.loadingScreenLoaded=false;c();function c(){f.GetOfficeUIConfiguration().then(function(p){o.LoadingMessage=p.LoadingMessage;i([p.DefaultStyle,p.DefaultTheme]).then(function(){o.loadingScreenLoaded=true});l(p.Configuration,JSPath.apply(".",p.Controls))})}function i(q){var p=[];$(q).each(function(r,s){p.push(d.Inject("OfficeUIStyle"+r,s))});return g.all(p)}function l(p,q){$(q).each(function(s,r){b[r.Name]=[n.get(r.Service),r.ConfigurationFile]});k.get(p).then(function(r){o.Title=r.data.Title;o.Icons=r.data.Icons;m(JSPath.apply(".Icon",o.Icons)).then(function(){a(q)})},function(r){OfficeUICore.Exceptions.OfficeUILoadingException("[OfficeUIController.LoadApplication] - The OfficeUI Application Definition file: '"+p+"' which is referenced from '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}function m(q){var p=[];$(q).each(function(r,s){p.push(e.Load(s))});return g.all(p)}function a(p){j(p).then(function(){o.isInitialized=true})}o.DisableApplicationIcon=function(q){var p=JSPath.apply('.{.Id == "'+q+'"}',o.Icons);if(p.length==0){OfficeUICore.Exceptions.OfficeUIElementNotFoundException("[OfficeUIController.DisableApplicationIcon] - An application icon with id '"+q+"' cannot be found.")}p[0].Disabled="True"};o.EnableApplicationIcon=function(q){var p=JSPath.apply('.{.Id == "'+q+'"}',o.Icons);if(p.length==0){OfficeUICore.Exceptions.OfficeUIElementNotFoundException("[OfficeUIController.EnableApplicationIcon] - An application icon with id '"+q+"' cannot be found.")}p[0].Disabled="False"};function j(p){var r=[];var q=[];$(p).each(function(t,s){var u=$.grep(q,function(v){return v.Name==s.Name});q.push(s);if(u.length>0){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.PreloadServices] - A service with name '"+s.Name+"' is already registered.")}r.push(h(s.Name,b[s.Name][0],s.ConfigurationFile))});return g.all(r)}function h(r,s,p){var q=g.defer();if(!$.isFunction(s.SetLoadingMessage)){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.InitializeService] - The service '"+r+"' does not implement the 'SetLoadingMessage(scope) { }' function.")}if(!$.isFunction(s.Initialize)){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.InitializeService] - The service '"+r+"' does not implement the 'Initialize(configurationFile) { }' function.")}s.SetLoadingMessage(o);s.Initialize(p).then(function(){q.resolve()});return q.promise}o.InitializeServiceCall=function(p,s,q){if(typeof b[p]==="undefined"||b[p]==""){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.InitializeServiceCall] - The service '"+p+"' could not be found.")}var r=b[p][0];return r[s](q,q)}});