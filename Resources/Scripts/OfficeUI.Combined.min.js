var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("CssInjectorService",["$q",function(a){var b={};var c=function(f,d){var e=document.createElement("link");e.id=f;e.rel="stylesheet";e.type="text/css";e.href=d;return e};b.Inject=function(g,e){var d=a.defer();var f;if(!angular.element("link#"+g).length){f=c(g,e);f.onload=d.resolve;angular.element("head").append(f);return d.promise}else{OfficeUICore.Exceptions.OfficeUICssInjectorServiceException("[CssInjectorService.Inject]: There is already a link with id '"+g+"'. A new element could not be created.")}};return b}]);OfficeUI.factory("ImagePreloaderService",["$q",function(b){var a={};a.Load=function(e){var d=b.defer();var c=document.createElement("img");c.onload=d.resolve;c.src=e;return d.promise};return a}]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{GetOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.OfficeUIConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(c){if(typeof c.data.Styles==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [Styles] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}if(typeof c.data.DefaultStyle==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [DefaultStyle] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}if(typeof c.data.Themes==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [Themes] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}if(typeof c.data.DefaultTheme==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [DefaultTheme] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}if(typeof c.data.Configuration==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [Configuration] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}if(typeof c.data.Controls==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [Controls] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}if(typeof c.data.LoadingMessage==="undefined"||c.data.Styles==""){OfficeUICore.Exceptions.OfficeUIInvalidConfigurationException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The configuration element [LoadingMessage] is missing or could not be found in the file '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"'")}var b=JSPath.apply('.{.name == "'+c.data.DefaultStyle+'"}',c.data.Styles);var d=JSPath.apply('.{.name == "'+c.data.DefaultTheme+'"}',c.data.Themes);if(b.length==0){OfficeUICore.Exceptions.OfficeUIConfigurationException("[OfficeUIController.Initialize] - The requested default style: '"+c.data.DefaultStyle+"' which is referenced from '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' cannot be found.")}if(d.length==0){OfficeUICore.Exceptions.OfficeUIConfigurationException("[OfficeUIController.Initialize] - The requested default theme: '"+c.data.DefaultTheme+"' which is referenced from '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' cannot be found.")}if(b.length>1){OfficeUICore.Exceptions.OfficeUIConfigurationException("[OfficeUIController.Initialize] - The requested default style: '"+c.data.DefaultStyle+"' which is referenced from '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' matches multiple defined styles.")}if(d.length>1){OfficeUICore.Exceptions.OfficeUIConfigurationException("[OfficeUIController.Initialize] - The requested default theme: '"+c.data.DefaultTheme+"' which is referenced from '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' matches multiple defined themes.")}return{Styles:c.data.Styles,Themes:c.data.Themes,Configuration:c.data.Configuration,Controls:c.data.Controls,LoadingMessage:c.data.LoadingMessage,DefaultStyle:b[0].stylesheet,DefaultTheme:d[0].stylesheet}},function(b){OfficeUICore.Exceptions.OfficeUILoadingException("[OfficeUIConfigurationService.GetOfficeUIConfiguration] - The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.controller("OfficeUIController",function(d,e,f,o,k,n,g){var b={};o.isInitialized=false;o.loadingScreenLoaded=false;c();function c(){f.GetOfficeUIConfiguration().then(function(p){o.LoadingMessage=p.LoadingMessage;i([p.DefaultStyle,p.DefaultTheme]).then(function(){o.loadingScreenLoaded=true});l(p.Configuration,JSPath.apply(".",p.Controls))})}function i(q){var p=[];$(q).each(function(r,s){p.push(d.Inject("OfficeUIStyle"+r,s))});return g.all(p)}function l(p,q){$(q).each(function(s,r){b[r.Name]=[n.get(r.Service),r.ConfigurationFile]});k.get(p).then(function(r){o.Title=r.data.Title;o.Icons=r.data.Icons;m(JSPath.apply(".Icon",o.Icons)).then(function(){a(q)})},function(r){OfficeUICore.Exceptions.OfficeUILoadingException("[OfficeUIController.LoadApplication] - The OfficeUI Application Definition file: '"+p+"' which is referenced from '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}function m(q){var p=[];$(q).each(function(r,s){p.push(e.Load(s))});return g.all(p)}function a(p){j(p).then(function(){o.isInitialized=true})}o.DisableApplicationIcon=function(q){var p=JSPath.apply('.{.Id == "'+q+'"}',o.Icons);if(p.length==0){OfficeUICore.Exceptions.OfficeUIElementNotFoundException("[OfficeUIController.DisableApplicationIcon] - An application icon with id '"+q+"' cannot be found.")}p[0].Disabled="True"};o.EnableApplicationIcon=function(q){var p=JSPath.apply('.{.Id == "'+q+'"}',o.Icons);if(p.length==0){OfficeUICore.Exceptions.OfficeUIElementNotFoundException("[OfficeUIController.DisableApplicationIcon] - An application icon with id '"+q+"' cannot be found.")}p[0].Disabled="False"};function j(p){var r=[];var q=[];$(p).each(function(t,s){var u=$.grep(q,function(v){return v.Name==s.Name});q.push(s);if(u.length>0){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.PreloadServices] - A service with name '"+s.Name+"' is already registered.")}r.push(h(s.Name,b[s.Name][0],s.ConfigurationFile))});return g.all(r)}function h(r,s,p){var q=g.defer();if(!$.isFunction(s.SetLoadingMessage)){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.InitializeService] - The service '"+r+"' does not implement the 'SetLoadingMessage(scope) { }' function.")}if(!$.isFunction(s.Initialize)){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.InitializeService] - The service '"+r+"' does not implement the 'Initialize(configurationFile) { }' function.")}s.SetLoadingMessage(o);s.Initialize(p).then(function(){q.resolve()});return q.promise}o.InitializeServiceCall=function(p,s,q){if(typeof b[p]==="undefined"||b[p]==""){OfficeUICore.Exceptions.OfficeUIServiceException("[OfficeUIController.InitializeServiceCall] - The service '"+p+"' could not be found.")}var r=b[p][0];return r[s](q,q)}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});OfficeUI.directive("cuToggleStyleAttributeOnHover",function(){return{restrict:"A",link:function(d,b,a){var c=a.cuToggleStyleAttributeOnHover;var e=JSON.parse(c);b.bind("mouseleave",function(){$.each(e,function(f,g){if(!b.hasClass("active")){b.css(f,"inherit")}})});b.bind("mouseenter",function(){$.each(e,function(f,g){b.css(f,g)})})}}});OfficeUI.filter("actionLegend",function(){return function(a){if(a.MenuItems){return a.Legend+' <i class="fa fa-caret-down"></i>'}return a.Legend}});OfficeUI.factory("OfficeUIRibbonControlService",["$rootScope","$http","$q","ImagePreloaderService",function(i,h,f,e){var d={};const c="OfficeUIRibbon_SelectedTab";var a;var b;var g=[];d.SetLoadingMessage=function(j){j.LoadingMessage="Office Web Controls Ribbon Control Initialization"};d.Initialize=function(j){var k=f.defer();h.get(j).then(function(m){if(typeof m.data.Configuration==="undefined"||m.data.Configuration==""){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' does not contain a 'Configuration' property.")}if(typeof m.data.Tabs==="undefined"||m.data.Tabs==""){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' does not contain a 'Tabs' property.")}if(typeof m.data.ContextualGroups==="undefined"||m.data.ContextualGroups==""){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' does not contain a 'ContextualGroups' property.")}if(m.data.Tabs.length<2){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.Initialize] - The file defining the ribbon '"+j+"' must contain at least 2 tabs.")}a=m.data.Configuration[0].PreserveSelectedRibbonTab=="True";i.Tabs=m.data.Tabs;i.ContextualGroups=m.data.ContextualGroups;if(a){var o=OfficeUICore.StateManagement.GetCookie(c);if(o==""){d.setActiveTab(i.Tabs[1].Id)}else{d.setActiveTab(o)}}else{d.setActiveTab(i.Tabs[1].Id)}var l=JSPath.apply(".Groups.Areas.Actions.Resource",i.Tabs);l.concat(JSPath.apply(".Tabs.Groups.Areas.Actions.Resource",i.ContextualGroups));var n=[];$(l).each(function(p,q){n.push(e.Load(q))});f.all(n).then(function(){k.resolve()})});return k.promise};d.isTabActive=function(j){return b==j};d.setActiveTab=function(j){var k=JSON.parse(JSON.stringify(i.Tabs)).splice(1,i.Tabs.length-1);var m=false;var l=$.grep(k,function(n){return n.Id==j});if(l.length>0){m=true}$.each(i.ContextualGroups,function(n,o){if(d.isContextualGroupActive(o.Id)){$.each(o.Tabs,function(q,p){k.push(p)})}});l=$.grep(k,function(n){return n.Id==j});if(l.length==0){OfficeUICore.Exceptions.ThrowException("OfficeUIRibbonControlServiceException","[OfficeUIRibbonControlService.setActiveTab] - The tab '"+j+"' cannot be activated. Either the tab does not exists, or the tab belongs to a contextual group which isn't active.")}else{if(a&&m){OfficeUICore.StateManagement.SetCookie(c,j,365)}b=j}};d.setActiveTabColor=function(k){var j=k[0];var l=k[1];if(b==j){return l}};d.isContextualGroupActive=function(j){var k=$.grep(g,function(l){return l==j});return k.length==1};d.activateContextualGroup=function(j){if(!d.isContextualGroupActive(j)){g.push(j)}};d.deactivateContextualGroup=function(k){if(d.isContextualGroupActive(k)){var j=$.grep(i.ContextualGroups,function(m){return m.Id==k});var l=$.grep(j[0].Tabs,function(m){return m.Id==b});if(l.length>0){d.setActiveTab(i.Tabs[1].Id)}g=$.grep(g,function(m){return m!=k})}};d.areContextualGroupsActive=function(){return g.length>0};return d}]);