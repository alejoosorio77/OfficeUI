var OfficeUIModule=angular.module("OfficeUI",[]);OfficeUIModule.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){new OfficeUIConfigurationException("The OfficeUI configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme}},function(b){new OfficeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIApplicationDefinitionService",function(a){return{getOfficeUIApplicationDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==""){new OfficeUIConfigurationException("The OfficeUI application definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation).then(function(b){return{Title:b.data.Title,Icons:b.data.Icons}},function(b){new OfficeUILoadingException("The OfficeUI application definition file: '"+$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("stylesheetFactory",["$http","OfficeUIConfigurationService",function(g,c){var d={};var b=[];var f="";var e=[];var a="";d.getOfficeUIConfiguration=function(){var h=c.getOfficeUIConfiguration();h.then(function(i){b=i.Styles;f=i.DefaultStyle;e=i.Themes;a=i.DefaultTheme});return h};d.changeStyle=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',b);if(h.length==0){new OfficeUIStylesheetException("A style with name '"+i+"' could not be found. Is the style defined in the 'availableStyles' array?")}else{if(h.length>1){new OfficeUIStylesheetException("Multiple entries in the 'availableStylesheets' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};d.changeTheme=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',e);if(h.length==0){new OfficeUIStylesheetException("A theme with name '"+i+"' could not be found. Is the style defined in the 'availableThemes' array?")}else{if(h.length>1){new OfficeUIStylesheetException("Multiple entries in the 'availableThemes' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};return d}]);OfficeUIModule.factory("applicationDefinitionFactory",["$http","OfficeUIApplicationDefinitionService",function(e,b){var a={};var d=[];var c="";a.getOfficeUIApplicationDefinition=function(){var f=b.getOfficeUIApplicationDefinition();f.then(function(g){d=g.Title;c=g.Icons});return f};return a}]);OfficeUIModule.controller("OfficeUIController",function(b,d,a){c();function c(){b.getOfficeUIConfiguration().then(function(e){a.style=b.changeStyle(e.DefaultStyle);a.theme=b.changeTheme(e.DefaultTheme)});d.getOfficeUIApplicationDefinition().then(function(e){a.Title=e.Title;a.Icons=e.Icons})}a.changeStyle=function(e){a.style=b.changeStyle(e)};a.changeTheme=function(e){a.theme=b.changeTheme(e)};a.refresh=function(){a.$apply()}});OfficeUIModule.directive("toggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.toggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)})}}});