var OfficeUIModule=angular.module("OfficeUI",[]);OfficeUIModule.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){new OfficeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,PreserveRibbonColor:b.data.PreserveRibbonColor,PreserveRibbonTheme:b.data.PreserveRibbonTheme}},function(b){new OfficeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIRibbonConfigurationService",function(a){return{getOfficeUIRibbonConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile==="undefined"||$.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile==""){new OfficeUIConfigurationException("The OfficeUI Ribbon Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile).then(function(b){return{ChangeActiveTabOnHover:b.data.ChangeActiveTabOnHover,PreserveRibbonState:b.data.PreserveRibbonState}},function(b){new OfficeUILoadingException("The OfficeUI Ribbon Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIApplicationDefinitionService",function(a){return{getOfficeUIApplicationDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==""){new OfficeUIConfigurationException("The OfficeUI application definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation).then(function(b){return{Title:b.data.Title,Icons:b.data.Icons}},function(b){new OfficeUILoadingException("The OfficeUI application definition file: '"+$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIRibbonDefinitionService",function(a){return{getOfficeUIRibbonDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation==""){new OfficeUIConfigurationException("The OfficeUI ribbon definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation).then(function(b){return{Tabs:b.data.Tabs,ContextualGroups:b.data.ContextualGroups}},function(b){new OfficeUILoadingException("The OfficeUI ribbon definition file: '"+$.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("stylesheetFactory",["$http","OfficeUIConfigurationService",function(g,c){var d={};var b=[];var f="";var e=[];var a="";d.getOfficeUIConfiguration=function(){var h=c.getOfficeUIConfiguration();h.then(function(i){b=i.Styles;f=i.DefaultStyle;e=i.Themes;a=i.DefaultTheme});return h};d.changeStyle=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',b);if(h.length==0){new OfficeUIStylesheetException("A style with name '"+i+"' could not be found. Is the style defined in the 'availableStyles' array?")}else{if(h.length>1){new OfficeUIStylesheetException("Multiple entries in the 'availableStylesheets' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};d.changeTheme=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',e);if(h.length==0){new OfficeUIStylesheetException("A theme with name '"+i+"' could not be found. Is the style defined in the 'availableThemes' array?")}else{if(h.length>1){new OfficeUIStylesheetException("Multiple entries in the 'availableThemes' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};return d}]);OfficeUIModule.factory("officeUIRibbonConfigurationFactory",["$http","OfficeUIRibbonConfigurationService",function(d,a){var c={};var b=null;c.getOfficeUIRibbonConfiguration=function(){var e=a.getOfficeUIRibbonConfiguration();e.then(function(f){});return e};return c}]);OfficeUIModule.factory("applicationDefinitionFactory",["$http","OfficeUIApplicationDefinitionService",function(e,b){var a={};var d=[];var c="";a.getOfficeUIApplicationDefinition=function(){var f=b.getOfficeUIApplicationDefinition();f.then(function(g){});return f};return a}]);OfficeUIModule.factory("ribbonDefinitionFactory",["$http","OfficeUIRibbonDefinitionService",function(e,d){var a={};var c=[];var b="";a.getOfficeUIRibbonDefinition=function(){var f=d.getOfficeUIRibbonDefinition();f.then(function(g){});return f};return a}]);OfficeUIModule.controller("OfficeUIController",function(l,c,k,h,n){var a={Hidden:1,Visible:2,Showed:3};var m="OfficeUI_Ribbon_ActiveTab";var g="OfficeUI_CurrentTheme";var e="OfficeUI_CurrentColor";var b=null;var i=null;var d=null;var j=[];var o=null;var p=getCookie(m);f();function f(){l.getOfficeUIConfiguration().then(function(s){var r=getCookie(g);var q=getCookie(e);if(r==""){n.Theme=l.changeTheme(s.DefaultTheme)}else{n.Theme=l.changeTheme(r)}if(q==""){n.Style=l.changeStyle(s.DefaultStyle)}else{n.Style=l.changeStyle(q)}});c.getOfficeUIApplicationDefinition().then(function(q){n.Title=q.Title;n.Icons=q.Icons});h.getOfficeUIRibbonConfiguration().then(function(q){i=q.ChangeActiveTabOnHover;d=q.PreserveRibbonState});k.getOfficeUIRibbonDefinition().then(function(r){n.Tabs=r.Tabs;n.ContextualGroups=r.ContextualGroups;if(d){if(p!=""){var q=jQuery.grep(n.Tabs,function(s){return s.Id===p});if(q.length>0){b=p}else{b=n.Tabs[1].Id}}else{b=n.Tabs[1].Id}}else{b=n.Tabs[1].Id}});o=a.Showed}n.changeStyle=function(q){setCookie(e,q,365);n.Style=l.changeStyle(q)};n.changeTheme=function(q){setCookie(g,q,365);n.Theme=l.changeTheme(q)};n.refresh=function(){n.$apply()};n.isTabActive=function(q){return b==q};n.setActiveTab=function(q){if(o==a.Hidden){o=a.Visible}b=q;if(d){setCookie(m,b,365)}};n.isAnyContextualGroupActive=function(){return j.length>0};n.isContextualGroupActive=function(q){var r=jQuery.grep(j,function(s){return(s===q)});return r.length>0};n.activateContextualGroup=function(q){j.push(q)};n.deactivateContextualGroup=function(t){j=jQuery.grep(j,function(u){return u!=t});var s=$("#"+t);var r=$(".contextual-tab",s);var q=jQuery.grep(r,function(v){var u=$(v).attr("id");return(u===b)});if(q.length>0){n.setActiveTab($(".tab:not(.application)",".ribbon").attr("id"))}if(d){setCookie(m,b,365)}};n.ribbonScroll=function(r){var q=$(".ribbon .active");var t=null;if(r.detail>0||r.wheelDelta<0){if(q.hasClass("contextual-tab")&&q.next().length>0){t=q.next()}else{var s=$(q).parent().parent();if($(s).next().length>0){t=$(".tab",s.next())}}}else{if(q.hasClass("contextual-tab")&&q.prev().length>0){t=q.prev()}else{var s=$(q).parent().parent();if($(s).prev().length>0&&!$(".tab",s.prev()).hasClass("application")){t=$(".tab",s.prev()).last()}}}if(t!=null){n.setActiveTab(t.attr("id"))}if(d&&t!=null){setCookie(m,t.attr("id"),365)}};n.setActiveTabOnHover=function(q){if(i){n.setActiveTab(q)}};n.setActiveTabColor=function(q,r){if(b==q){return r}};n.isRibbonShowed=function(){return o==a.Showed};n.isRibbonVisible=function(){return o==a.Visible};n.isRibbonHidden=function(){return o==a.Hidden};n.toggleRibbonState=function(){if(o==a.Showed){o=a.Hidden}if(o==a.Visible){o=a.Showed}}});OfficeUIModule.directive("toggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.toggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)})}}});OfficeUIModule.directive("toggleStyleAttributeOnHover",function(){return{restrict:"A",link:function(d,b,a){var c=a.toggleStyleAttributeOnHover;var e=JSON.parse(c);b.bind("mouseleave",function(){$.each(e,function(f,g){if(!b.hasClass("active")){b.css(f,"inherit")}})});b.bind("mouseenter",function(){$.each(e,function(f,g){b.css(f,g)})})}}});OfficeUIModule.directive("onHover",function(){return{restrict:"A",link:function(d,c,b){var a=b.onHover;c.bind("mouseenter",function(){d.$apply(a)})}}});OfficeUIModule.directive("onScroll",function(){return{restrict:"A",link:function(c,b,a){var d=a.onScroll;b.on("DOMMouseScroll mousewheel",function(f){c.$apply(function(e){e[d](f.originalEvent)});f.preventDefault()})}}});OfficeUIModule.directive("dynamicEventHandling",function(){return{restrict:"A",link:function(d,c,b){var e=b.id;if(typeof e==="undefined"||e==""){new OfficeUIDynamicEventHandlingException("The directive 'dynamicEventHandling' could not be placed on an element without an id attribute.")}else{var a=$.fn.OfficeUICore.searchEvent(e);if(a!=null){c.on(a.handler,function(){a.action()})}}}}});