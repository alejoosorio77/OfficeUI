var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,Configuration:b.data.Configuration,Controls:b.data.Controls}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.factory("CssInjectorService",["$q",function(a){var c={};var d=function(g,e){var f=document.createElement("link");f.id=g;f.rel="stylesheet";f.type="text/css";f.href=e;return f};var b=function(g,f){for(var h in document.styleSheets){var e=document.styleSheets[h].href||"";if(e.split("/").slice(-1).join()===g){f.resolve();return}}setTimeout(function(){b(g,f)},50)};c.Inject=function(h,f){var e=a.defer();var g;if(!angular.element("link#"+h).length){g=d(h,f);g.onload=e.resolve;angular.element("head").append(g);b(f,e);return e.promise}};return c}]);OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});OfficeUI.controller("OfficeUIController",function(d,c,a,e){a.isInitialized=false;a.loadingScreenLoaded=false;b();function b(){c.getOfficeUIConfiguration().then(function(h){var f=JSPath.apply('.{.name == "'+h.DefaultStyle+'"}',h.Styles);var g=JSPath.apply('.{.name == "'+h.DefaultTheme+'"}',h.Themes);d.Inject("OfficeUIStyle",f[0].stylesheet);d.Inject("OfficeUITheme",g[0].stylesheet).then(function(){a.loadingScreenLoaded=true});e.get(h.Configuration).then(function(i){a.Title=i.data.Title;a.Icons=i.data.Icons;a.isInitialized=true},function(i){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+h.Configuration+"' could not be loaded.")})})}});