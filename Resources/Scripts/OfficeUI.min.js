var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,Configuration:b.data.Configuration,Controls:b.data.Controls}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.factory("PreloaderService",["$q",function(b){function a(c){}a.PreloadImages=function(d){var c=new a(d);return(c.load())}}]);OfficeUI.factory("CssInjectorService",["$q",function(a){var b={};var c=function(f,d){var e=document.createElement("link");e.id=f;e.rel="stylesheet";e.type="text/css";e.href=d;return e};b.Inject=function(g,e){var d=a.defer();var f;if(!angular.element("link#"+g).length){f=c(g,e);f.onload=d.resolve;angular.element("head").append(f);return d.promise}};return b}]);OfficeUI.factory("PreloaderService",["$q",function(b){var a={};a.Load=function(e){var d=b.defer();var c=document.createElement("img");c.onload=d.resolve;c.src=e;return d.promise};return a}]);OfficeUI.factory("OfficeUIRibbonControlService",["$rootScope","$http","$q","PreloaderService",function(a,e,b,d){var c={};c.SetLoadingMessage=function(f){f.LoadingMessage="OfficeUI Ribbon Control Initialization"};c.Initialize=function(f){var g=b.defer();e.get(f).then(function(i){a.Tabs=i.data.Tabs;a.ContextualGroups=i.data.ContextualGroups;var h=JSPath.apply(".Groups.Areas.Actions.Resource",a.Tabs);h.concat(JSPath.apply(".Tabs.Groups.Areas.Actions.Resource",a.ContextualGroups));var j=[];$(h).each(function(k,l){j.push(d.Load(l))});b.all(j).then(function(){g.resolve()})});return g.promise};return c}]);OfficeUI.controller("OfficeUIController",function(d,e,f,o,k,n,g){var b={};o.isInitialized=false;o.loadingScreenLoaded=false;c();function c(){o.LoadingMessage="Loading the application";f.getOfficeUIConfiguration().then(function(r){var p=JSPath.apply('.{.name == "'+r.DefaultStyle+'"}',r.Styles);var q=JSPath.apply('.{.name == "'+r.DefaultTheme+'"}',r.Themes);i([p[0].stylesheet,q[0].stylesheet]).then(function(){o.loadingScreenLoaded=true});l(r.Configuration,JSPath.apply(".",r.Controls))})}function i(q){var p=[];$(q).each(function(r,s){p.push(d.Inject("OfficeUIStyle"+r,s))});return g.all(p)}function l(p,q){$(q).each(function(s,r){b[r.Name]=[n.get(r.Service),r.ConfigurationFile]});k.get(p).then(function(r){o.Title=r.data.Title;o.Icons=r.data.Icons;m(JSPath.apply(".Icon",o.Icons)).then(function(){a(q)})},function(r){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+data.Configuration+"' could not be loaded.")})}function m(q){var p=[];$(q).each(function(r,s){p.push(e.Load(s))});return g.all(p)}function a(p){j(p).then(function(){o.isInitialized=true})}function j(p){var q=[];$(p).each(function(s,r){q.push(h(b[r.Name][0],r.ConfigurationFile))});return g.all(q)}function h(r,p){r.SetLoadingMessage(o);var q=g.defer();r.Initialize(p).then(function(){q.resolve()});return q.promise}o.InitializeServiceCall=function(p,s,q){var r=b[p][0];r[s](q)}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});