var OfficeUIModule=angular.module("OfficeUI",[]);OfficeUIModule.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){new OfficeUIConfigurationException("The OfficeUI configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme}},function(b){new OfficeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("stylesheetFactory",["$http","OfficeUIConfigurationService",function(g,c){var d={};var b=[];var f="";var e=[];var a="";d.getOfficeUIConfiguration=function(){var h=c.getOfficeUIConfiguration();h.then(function(i){b=i.Styles;f=i.DefaultStyle;e=i.Themes;a=i.DefaultTheme});return h};d.changeStyle=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',b);if(h.length==0){new OfficeUIStylesheetException("A style with name '"+i+"' could not be found. Is the style defined in the 'availableStyles' array?")}else{if(h.length>1){new OfficeUIStylesheetException("Multiple entries in the 'availableStylesheets' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};d.changeTheme=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',e);if(h.length==0){new OfficeUIStylesheetException("A theme with name '"+i+"' could not be found. Is the style defined in the 'availableThemes' array?")}else{if(h.length>1){new OfficeUIStylesheetException("Multiple entries in the 'availableThemes' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};return d}]);OfficeUIModule.controller("OfficeUIController",function(b,a){c();function c(){b.getOfficeUIConfiguration().then(function(d){a.style=b.changeStyle(d.DefaultStyle);a.theme=b.changeTheme(d.DefaultTheme)})}a.changeStyle=function(d){a.style=b.changeStyle(d)};a.changeTheme=function(d){a.theme=b.changeTheme(d)};a.refresh=function(){a.$apply()}});