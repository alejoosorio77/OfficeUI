var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,Configuration:b.data.Configuration,Controls:b.data.Controls}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.factory("PreloaderService",["$q",function(b){function a(c){}a.PreloadImages=function(d){var c=new a(d);return(c.load())}}]);OfficeUI.factory("CssInjectorService",["$q",function(a){var b={};var c=function(f,d){var e=document.createElement("link");e.id=f;e.rel="stylesheet";e.type="text/css";e.href=d;return e};b.Inject=function(g,e){var d=a.defer();var f;if(!angular.element("link#"+g).length){f=c(g,e);f.onload=d.resolve;angular.element("head").append(f);return d.promise}};return b}]);OfficeUI.factory("PreloaderService",["$q",function(b){var a={};a.Load=function(d){var c=b.defer();$(d).each(function(g,f){var e=document.createElement("img");e.onload=c.resolve;e.src=f});return c.promise};return a}]);OfficeUI.factory("OfficeUIRibbonControlService",[function(){var a={};a.Show=function(){console.log("Registering the OfficeUIRibbonControlService object.")};return a}]);OfficeUI.controller("OfficeUIController",function(f,g,e,b,h,c){var a={};b.isInitialized=false;b.loadingScreenLoaded=false;d();function d(){e.getOfficeUIConfiguration().then(function(l){var i=JSPath.apply('.{.name == "'+l.DefaultStyle+'"}',l.Styles);var k=JSPath.apply('.{.name == "'+l.DefaultTheme+'"}',l.Themes);var j=JSPath.apply(".",l.Controls);$(j).each(function(n,m){a[m.Name]=[c.get(m.Service),m.ConfigurationFile]});f.Inject("OfficeUIStyle",i[0].stylesheet);f.Inject("OfficeUITheme",k[0].stylesheet).then(function(){b.loadingScreenLoaded=true});h.get(l.Configuration).then(function(m){b.Title=m.data.Title;b.Icons=m.data.Icons;var n=JSPath.apply(".Icon",b.Icons);g.Load(n).then(function(){b.isInitialized=true})},function(m){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+l.Configuration+"' could not be loaded.")})})}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});