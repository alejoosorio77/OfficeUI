var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,Configuration:b.data.Configuration,Controls:b.data.Controls}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.factory("PreloaderService",["$q",function(b){function a(c){}a.PreloadImages=function(d){var c=new a(d);return(c.load())}}]);OfficeUI.factory("CssInjectorService",["$q",function(a){var b={};var c=function(f,d){var e=document.createElement("link");e.id=f;e.rel="stylesheet";e.type="text/css";e.href=d;return e};b.Inject=function(g,e){var d=a.defer();var f;if(!angular.element("link#"+g).length){f=c(g,e);f.onload=d.resolve;angular.element("head").append(f);return d.promise}};return b}]);OfficeUI.factory("PreloaderService",["$q",function(b){var a={};a.Load=function(d){var c=b.defer();$(d).each(function(g,f){var e=document.createElement("img");e.onload=c.resolve;e.src=f});return c.promise};return a}]);OfficeUI.factory("OfficeUIRibbonControlService",["$rootScope","$http","PreloaderService",function(a,d,c){var b={};b.Initialize=function(e){d.get(e).then(function(g){a.Tabs=g.data.Tabs;a.ContextualGroups=g.data.ContextualGroups;var f=JSPath.apply(".Groups.Areas.Actions.Resource",a.Tabs);f.concat(JSPath.apply(".Tabs.Groups.Areas.Actions.Resource",a.ContextualGroups));c.Load(f)})};return b}]);OfficeUI.controller("OfficeUIController",function(b,d,e,i,g,h){var a={};i.isInitialized=false;i.loadingScreenLoaded=false;c();function c(){e.getOfficeUIConfiguration().then(function(m){var j=JSPath.apply('.{.name == "'+m.DefaultStyle+'"}',m.Styles);var l=JSPath.apply('.{.name == "'+m.DefaultTheme+'"}',m.Themes);var k=JSPath.apply(".",m.Controls);$(k).each(function(o,n){a[n.Name]=[h.get(n.Service),n.ConfigurationFile]});b.Inject("OfficeUIStyle",j[0].stylesheet);b.Inject("OfficeUITheme",l[0].stylesheet).then(function(){i.loadingScreenLoaded=true});g.get(m.Configuration).then(function(n){i.Title=n.data.Title;i.Icons=n.data.Icons;var o=JSPath.apply(".Icon",i.Icons);d.Load(o).then(function(){$(k).each(function(q,p){f(a[p.Name][0],p.ConfigurationFile)});i.isInitialized=true})},function(n){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+m.Configuration+"' could not be loaded.")})})}function f(k,j){k.Initialize(j)}i.InitializeServiceCall=function(j,m,k){var l=a[j][0];l[m](k)}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});