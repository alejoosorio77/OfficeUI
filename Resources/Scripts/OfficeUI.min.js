var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,Configuration:b.data.Configuration,Controls:b.data.Controls}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.factory("PreloaderService",["$q",function(b){function a(c){}a.PreloadImages=function(d){var c=new a(d);return(c.load())}}]);OfficeUI.factory("CssInjectorService",["$q",function(a){var b={};var c=function(f,d){var e=document.createElement("link");e.id=f;e.rel="stylesheet";e.type="text/css";e.href=d;return e};b.Inject=function(g,e){var d=a.defer();var f;if(!angular.element("link#"+g).length){f=c(g,e);f.onload=d.resolve;angular.element("head").append(f);return d.promise}};return b}]);OfficeUI.factory("PreloaderService",["$q",function(b){var a={};a.Load=function(e){var d=b.defer();var c=document.createElement("img");c.onload=d.resolve;c.src=e;return d.promise};return a}]);OfficeUI.factory("OfficeUIRibbonControlService",["$rootScope","$http","$q","PreloaderService",function(a,e,b,d){var c={};c.Initialize=function(f){var g=b.defer();e.get(f).then(function(i){a.Tabs=i.data.Tabs;a.ContextualGroups=i.data.ContextualGroups;var h=JSPath.apply(".Groups.Areas.Actions.Resource",a.Tabs);h.concat(JSPath.apply(".Tabs.Groups.Areas.Actions.Resource",a.ContextualGroups));var j=[];$(h).each(function(k,l){j.push(d.Load(l))});b.all(j).then(function(){g.resolve()})});return g.promise};return c}]);OfficeUI.controller("OfficeUIController",function(c,d,e,j,h,i,f){var a={};j.isInitialized=false;j.loadingScreenLoaded=false;b();function b(){e.getOfficeUIConfiguration().then(function(o){var k=JSPath.apply('.{.name == "'+o.DefaultStyle+'"}',o.Styles);var n=JSPath.apply('.{.name == "'+o.DefaultTheme+'"}',o.Themes);var l=JSPath.apply(".",o.Controls);$(l).each(function(q,p){a[p.Name]=[i.get(p.Service),p.ConfigurationFile]});var m=[];m.push(c.Inject("OfficeUIStyle",k[0].stylesheet));m.push(c.Inject("OfficeUITheme",n[0].stylesheet));f.all(m).then(function(){j.loadingScreenLoaded=true});h.get(o.Configuration).then(function(p){j.Title=p.data.Title;j.Icons=p.data.Icons;var r=JSPath.apply(".Icon",j.Icons);var q=[];var s=[];$(r).each(function(t,u){q.push(d.Load(u))});f.all(q).then(function(){$(l).each(function(u,t){s.push(g(a[t.Name][0],t.ConfigurationFile))});f.all(s).then(function(){j.isInitialized=true})})},function(p){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+o.Configuration+"' could not be loaded.")})})}function g(m,k){var l=f.defer();m.Initialize(k).then(function(){l.resolve()});return l.promise}j.InitializeServiceCall=function(k,n,l){var m=a[k][0];m[n](l)}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});