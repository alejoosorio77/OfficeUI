var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,PreserveStyle:b.data.PreserveStyle,PreserveTheme:b.data.PreserveTheme}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.factory("OfficeUIApplicationDefinitionService",function(a){return{getOfficeUIApplicationDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI application definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation).then(function(b){return{Title:b.data.Title,Icons:b.data.Icons}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUI.directive("officeuiApplication",function(){return{restrict:"AE",replace:true,templateUrl:"/Resources/Data/Templates/OfficeUI.html"}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});OfficeUI.controller("OfficeUIController",function(d,b,a){a.isInitialized=false;a.loadingScreenLoaded=false;c();function c(){d.getOfficeUIConfiguration().then(function(g){var e=JSPath.apply('.{.name == "'+g.DefaultStyle+'"}',g.Styles);a.Style=e[0].stylesheet;var f=JSPath.apply('.{.name == "'+g.DefaultTheme+'"}',g.Themes);a.Theme=f[0].stylesheet;a.loadingScreenLoaded=true});b.getOfficeUIApplicationDefinition().then(function(e){a.Title=e.Title;a.Icons=e.Icons});setTimeout(function(){a.isInitialized=true;a.$apply()},2000)}});