var OfficeUIModule=angular.module("OfficeUI",["ngSanitize"]);OfficeUIModule.directive("officeuiApplication",function(){return{restrict:"AE",replace:true,templateUrl:"/Resources/Data/Templates/OfficeUI.Application.html"}});OfficeUIModule.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,PreserveStyle:b.data.PreserveStyle,PreserveTheme:b.data.PreserveTheme}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIRibbonConfigurationService",function(a){return{getOfficeUIRibbonConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile==="undefined"||$.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Ribbon Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile).then(function(b){return{ChangeActiveTabOnHover:b.data.ChangeActiveTabOnHover,PreserveRibbonState:b.data.PreserveRibbonState}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Ribbon Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIApplicationDefinitionService",function(a){return{getOfficeUIApplicationDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI application definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation).then(function(b){return{Title:b.data.Title,Icons:b.data.Icons}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIRibbonDefinitionService",function(a){return{getOfficeUIRibbonDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI ribbon definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation).then(function(b){return{Tabs:b.data.Tabs,ContextualGroups:b.data.ContextualGroups}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI ribbon definition file: '"+$.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("stylesheetFactory",["$http","OfficeUIConfigurationService",function(g,c){var d={};var b=[];var f="";var e=[];var a="";d.getOfficeUIConfiguration=function(){var h=c.getOfficeUIConfiguration();h.then(function(i){b=i.Styles;f=i.DefaultStyle;e=i.Themes;a=i.DefaultTheme});return h};d.changeStyle=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',b);if(h.length==0){OfficeUICore.Exceptions.officeUIStylesheetException("A style with name '"+i+"' could not be found. Is the style defined in the 'availableStyles' array?")}else{if(h.length>1){OfficeUICore.Exceptions.officeUIStylesheetException("Multiple entries in the 'availableStylesheets' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};d.changeTheme=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',e);if(h.length==0){OfficeUICore.Exceptions.officeUIStylesheetException("A theme with name '"+i+"' could not be found. Is the style defined in the 'availableThemes' array?")}else{if(h.length>1){OfficeUICore.Exceptions.officeUIStylesheetException("Multiple entries in the 'availableThemes' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};return d}]);OfficeUIModule.controller("OfficeUIController",function(b,h,g,r,o){var l={Hidden:1,Visible:2,Showed:3,Showed_Initialized:99};var a="OfficeUI_Ribbon_ActiveTab";var f="OfficeUI_CurrentStyle";var j="OfficeUI_CurrentTheme";var c=365;var d=null;var s=null;var i=[];var e=[];var n=l.Showed_Initialized;var m=OfficeUICore.StateManagement.GetCookie(a);var p=OfficeUICore.StateManagement.GetCookie(f);var q=OfficeUICore.StateManagement.GetCookie(j);k();function k(){setTimeout(function(){b.getOfficeUIConfiguration().then(function(t){s=t;if(p==""){o.Style=b.changeStyle(s.DefaultStyle)}else{o.Style=b.changeStyle(p)}if(q==""){o.Theme=b.changeTheme(s.DefaultTheme)}else{o.Theme=b.changeTheme(q)}})},10000);h.getOfficeUIApplicationDefinition().then(function(t){o.Title=t.Title;o.Icons=t.Icons});r.getOfficeUIRibbonConfiguration().then(function(t){i=t});g.getOfficeUIRibbonDefinition().then(function(u){o.Tabs=u.Tabs;o.ContextualGroups=u.ContextualGroups;if(i.PreserveRibbonState&&m!=""){var t=jQuery.grep(o.Tabs,function(v){return v.Id===m});if(t.length>0){d=m}else{d=o.Tabs[1].Id}}else{d=o.Tabs[1].Id}})}o.changeStyle=function(t){if(s.PreserveStyle){OfficeUICore.StateManagement.SetCookie(f,t,c)}o.Style=b.changeStyle(t)};o.changeTheme=function(t){if(s.PreserveTheme){OfficeUICore.StateManagement.SetCookie(j,t,c)}o.Theme=b.changeTheme(t)};o.refresh=function(){o.$apply()};o.isTabActive=function(t){return d==t};o.setActiveTab=function(t){if(n==l.Hidden){n=l.Visible}d=t;if(i.PreserveRibbonState){OfficeUICore.StateManagement.SetCookie(a,d,c)}};o.isAnyContextualGroupActive=function(){return e.length>0};o.isContextualGroupActive=function(t){var u=jQuery.grep(e,function(v){return(v===t)});return u.length>0};o.activateContextualGroup=function(t){e.push(t)};o.deactivateContextualGroup=function(w){e=jQuery.grep(e,function(x){return x!=w});var v=$("#"+w);var u=$(".contextual-tab",v);var t=jQuery.grep(u,function(y){var x=$(y).attr("id");return(x===d)});if(t.length>0){o.setActiveTab($(".tab:not(.application)",".ribbon").attr("id"))}};o.ribbonScroll=function(u){var t=$(".ribbon .active");var w=null;if(u.detail>0||u.wheelDelta<0){if(t.hasClass("contextual-tab")&&t.next().length>0){w=t.next()}else{var v=$(t).parent().parent();if($(v).next().length>0){w=$(".tab",v.next())}}}else{if(t.hasClass("contextual-tab")&&t.prev().length>0){w=t.prev()}else{var v=$(t).parent().parent();if($(v).prev().length>0&&!$(".tab",v.prev()).hasClass("application")){w=$(".tab",v.prev()).last()}}}if(w!=null){o.setActiveTab(w.attr("id"))}};o.setActiveTabOnHover=function(t){if(i.ChangeActiveTabOnHover){o.setActiveTab(t)}};o.setActiveTabColor=function(t,u){if(d==t){return u}};o.isRibbonShowed=function(){return n==l.Showed};o.isRibbonInitialized=function(){return n==l.Showed_Initialized};o.isRibbonVisible=function(){return n==l.Visible};o.isRibbonHidden=function(){return n==l.Hidden};o.toggleRibbonState=function(){if(n==l.Showed||n==l.Showed_Initialized){n=l.Hidden}if(n==l.Visible){n=l.Showed}};$(window).on("click",function(t){if(o.isRibbonVisible()){n=l.Hidden}o.$apply()})});OfficeUIModule.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});OfficeUIModule.directive("officeuiToggleStyleAttributeOnHover",function(){return{restrict:"A",link:function(d,b,a){var c=a.officeuiToggleStyleAttributeOnHover;var e=JSON.parse(c);b.bind("mouseleave",function(){$.each(e,function(f,g){if(!b.hasClass("active")){b.css(f,"inherit")}})});b.bind("mouseenter",function(){$.each(e,function(f,g){b.css(f,g)})})}}});OfficeUIModule.directive("officeuiOnHover",function(){return{restrict:"A",link:function(d,c,b){var a=b.officeuiOnHover;c.bind("mouseenter",function(){d.$apply(a)})}}});OfficeUIModule.directive("officeuiOnScroll",function(){return{restrict:"A",link:function(c,b,a){var d=a.officeuiOnScroll;b.on("DOMMouseScroll mousewheel",function(f){c.$apply(function(e){e[d](f.originalEvent)});f.preventDefault()})}}});OfficeUIModule.directive("officeuiDynamicEventHandling",function(){return{restrict:"A",link:function(d,c,b){var e=b.id;if(typeof e==="undefined"||e==""){OfficeUICore.Exceptions.officeUIDynamicEventHandlingException("The directive 'officeuiDynamicEventHandling' could not be placed on an element without an id attribute.")}else{var a=OfficeUICore.SearchEvent("#"+e);if(a!=null){c.on(a.handler,function(){a.action()})}}}}});OfficeUIModule.directive("officeuiStopPropagation",function(){return{restrict:"A",link:function(c,b,a){b.bind(a.officeuiStopPropagation,function(d){d.stopPropagation()})}}});OfficeUIModule.directive("officeuiTooltip",function(){return{restrict:"A",link:function(c,b,a){b.bind("mouseenter",function(g){if(!b.hasClass("disabled")){var d=$(".tooltip",b.parent());var f=setTimeout(function(){$(d).show()},1000);b.bind("mouseleave",function(h){clearTimeout(f);$.fn.OfficeUI.waitHandleHideTooltip=setTimeout(function(){$(d).hide()},500)})}})}}});OfficeUIModule.directive("officeuiControlDropdown",function(){return{restrict:"A",link:function(c,b,a){$(b).OfficeUIDropdown()}}});OfficeUIModule.directive("officeuiControlDropdownItem",function(){return{restrict:"A",link:function(scope,element,attributes){$(element).click(function(){var selectedLiText=$(this).html();$(".dropdown-legend",$(this).parent().parent()).html(selectedLiText);$.fn.selectedItem=selectedLiText;var attribute=$(this).parent().parent().attr("data-on-change");if(typeof attribute!=="undefined"&&attribute!=""){eval(attribute)}$(this).parent().parent().Close();$(this).removeClass("focus")})}}});OfficeUIModule.filter("actionLegend",function(){return function(a){if(a.MenuItems){return a.Legend+' <i class="fa fa-caret-down"></i>'}return a.Legend}});