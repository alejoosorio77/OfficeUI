var OfficeUIModule=angular.module("OfficeUI",["ngSanitize"]);OfficeUIModule.directive("officeuiApplication",function(){return{restrict:"AE",replace:true,templateUrl:"/Resources/Data/Templates/OfficeUI.Application.html"}});OfficeUIModule.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,PreserveStyle:b.data.PreserveStyle,PreserveTheme:b.data.PreserveTheme}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIRibbonConfigurationService",function(a){return{getOfficeUIRibbonConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile==="undefined"||$.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Ribbon Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile).then(function(b){return{ChangeActiveTabOnHover:b.data.ChangeActiveTabOnHover,PreserveRibbonState:b.data.PreserveRibbonState}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Ribbon Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIRibbonConfigurationFile+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIApplicationDefinitionService",function(a){return{getOfficeUIApplicationDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI application definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation).then(function(b){return{Title:b.data.Title,Icons:b.data.Icons}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+$.fn.OfficeUI.Settings.OfficeUIApplicationDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("OfficeUIRibbonDefinitionService",function(a){return{getOfficeUIRibbonDefinition:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI ribbon definition file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation).then(function(b){return{Tabs:b.data.Tabs,ContextualGroups:b.data.ContextualGroups}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI ribbon definition file: '"+$.fn.OfficeUI.Settings.OfficeUIRibbonDefinitionFileLocation+"' could not be loaded.")})}}});OfficeUIModule.factory("stylesheetFactory",["$http","OfficeUIConfigurationService",function(g,c){var d={};var b=[];var f="";var e=[];var a="";d.getOfficeUIConfiguration=function(){var h=c.getOfficeUIConfiguration();h.then(function(i){b=i.Styles;f=i.DefaultStyle;e=i.Themes;a=i.DefaultTheme});return h};d.changeStyle=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',b);if(h.length==0){OfficeUICore.Exceptions.officeUIStylesheetException("A style with name '"+i+"' could not be found. Is the style defined in the 'availableStyles' array?")}else{if(h.length>1){OfficeUICore.Exceptions.officeUIStylesheetException("Multiple entries in the 'availableStylesheets' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};d.changeTheme=function(i){var h=JSPath.apply('.{.name == "'+i+'"}',e);if(h.length==0){OfficeUICore.Exceptions.officeUIStylesheetException("A theme with name '"+i+"' could not be found. Is the style defined in the 'availableThemes' array?")}else{if(h.length>1){OfficeUICore.Exceptions.officeUIStylesheetException("Multiple entries in the 'availableThemes' array matches a style with name '"+i+"'")}else{if(h.length==1){return h[0].stylesheet}}}};return d}]);OfficeUIModule.factory("officeUIRibbonConfigurationFactory",["$http","OfficeUIRibbonConfigurationService",function(c,a){var b={};b.getOfficeUIRibbonConfiguration=function(){var d=a.getOfficeUIRibbonConfiguration();d.then(function(e){});return d};return b}]);OfficeUIModule.factory("applicationDefinitionFactory",["$http","OfficeUIApplicationDefinitionService",function(e,b){var a={};var d=[];var c="";a.getOfficeUIApplicationDefinition=function(){var f=b.getOfficeUIApplicationDefinition();f.then(function(g){});return f};return a}]);OfficeUIModule.factory("ribbonDefinitionFactory",["$http","OfficeUIRibbonDefinitionService",function(e,d){var a={};var c=[];var b="";a.getOfficeUIRibbonDefinition=function(){var f=d.getOfficeUIRibbonDefinition();f.then(function(g){});return f};return a}]);OfficeUIModule.controller("OfficeUIController",function(b,d,j,h,p){var m={Hidden:1,Visible:2,Showed:3,Showed_Initialized:99};var a="OfficeUI_Ribbon_ActiveTab";var g="OfficeUI_CurrentStyle";var k="OfficeUI_CurrentTheme";var s="OfficeUI_RibbonState";var c=365;var e=null;var t=null;var i=[];var f=[];var o=null;var n=OfficeUICore.StateManagement.GetCookie(a);var q=OfficeUICore.StateManagement.GetCookie(g);var r=OfficeUICore.StateManagement.GetCookie(k);l();function l(){b.getOfficeUIConfiguration().then(function(u){t=u;if(q==""){p.Style=b.changeStyle(t.DefaultStyle)}else{p.Style=b.changeStyle(q)}if(r==""){p.Theme=b.changeTheme(t.DefaultTheme)}else{p.Theme=b.changeTheme(r)}});d.getOfficeUIApplicationDefinition().then(function(u){p.Title=u.Title;p.Icons=u.Icons});h.getOfficeUIRibbonConfiguration().then(function(u){i=u});j.getOfficeUIRibbonDefinition().then(function(v){p.Tabs=v.Tabs;p.ContextualGroups=v.ContextualGroups;if(i.PreserveRibbonState&&n!=""){var u=jQuery.grep(p.Tabs,function(w){return w.Id===n});if(u.length>0){e=n}else{e=p.Tabs[1].Id}}else{e=p.Tabs[1].Id}});o=m.Showed_Initialized}p.changeStyle=function(u){if(t.PreserveStyle){OfficeUICore.StateManagement.SetCookie(g,u,c)}p.Style=b.changeStyle(u)};p.changeTheme=function(u){if(t.PreserveTheme){OfficeUICore.StateManagement.SetCookie(k,u,c)}p.Theme=b.changeTheme(u)};p.refresh=function(){p.$apply()};p.isTabActive=function(u){return e==u};p.setActiveTab=function(u){if(o==m.Hidden){o=m.Visible}e=u;if(i.PreserveRibbonState){OfficeUICore.StateManagement.SetCookie(a,e,c)}};p.isAnyContextualGroupActive=function(){return f.length>0};p.isContextualGroupActive=function(u){var v=jQuery.grep(f,function(w){return(w===u)});return v.length>0};p.activateContextualGroup=function(u){f.push(u)};p.deactivateContextualGroup=function(x){f=jQuery.grep(f,function(y){return y!=x});var w=$("#"+x);var v=$(".contextual-tab",w);var u=jQuery.grep(v,function(z){var y=$(z).attr("id");return(y===e)});if(u.length>0){p.setActiveTab($(".tab:not(.application)",".ribbon").attr("id"))}};p.ribbonScroll=function(v){var u=$(".ribbon .active");var x=null;if(v.detail>0||v.wheelDelta<0){if(u.hasClass("contextual-tab")&&u.next().length>0){x=u.next()}else{var w=$(u).parent().parent();if($(w).next().length>0){x=$(".tab",w.next())}}}else{if(u.hasClass("contextual-tab")&&u.prev().length>0){x=u.prev()}else{var w=$(u).parent().parent();if($(w).prev().length>0&&!$(".tab",w.prev()).hasClass("application")){x=$(".tab",w.prev()).last()}}}if(x!=null){p.setActiveTab(x.attr("id"))}};p.setActiveTabOnHover=function(u){if(i.ChangeActiveTabOnHover){p.setActiveTab(u)}};p.setActiveTabColor=function(u,v){if(e==u){return v}};p.isRibbonShowed=function(){return o==m.Showed};p.isRibbonInitialized=function(){return o==m.Showed_Initialized};p.isRibbonVisible=function(){return o==m.Visible};p.isRibbonHidden=function(){return o==m.Hidden};p.toggleRibbonState=function(){if(o==m.Showed||o==m.Showed_Initialized){o=m.Hidden;if(i.PreserveRibbonState){OfficeUICore.StateManagement.SetCookie(s,m.Hidden,c)}}if(o==m.Visible){o=m.Showed;if(i.PreserveRibbonState){OfficeUICore.StateManagement.SetCookie(s,m.Showed,c)}}};$(window).on("click",function(u){if(p.isRibbonVisible()){o=m.Hidden}p.$apply()})});OfficeUIModule.directive("toggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.toggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});OfficeUIModule.directive("toggleStyleAttributeOnHover",function(){return{restrict:"A",link:function(d,b,a){var c=a.toggleStyleAttributeOnHover;var e=JSON.parse(c);b.bind("mouseleave",function(){$.each(e,function(f,g){if(!b.hasClass("active")){b.css(f,"inherit")}})});b.bind("mouseenter",function(){$.each(e,function(f,g){b.css(f,g)})})}}});OfficeUIModule.directive("onHover",function(){return{restrict:"A",link:function(d,c,b){var a=b.onHover;c.bind("mouseenter",function(){d.$apply(a)})}}});OfficeUIModule.directive("onScroll",function(){return{restrict:"A",link:function(c,b,a){var d=a.onScroll;b.on("DOMMouseScroll mousewheel",function(f){c.$apply(function(e){e[d](f.originalEvent)});f.preventDefault()})}}});OfficeUIModule.directive("dynamicEventHandling",function(){return{restrict:"A",link:function(d,c,b){var e=b.id;if(typeof e==="undefined"||e==""){OfficeUICore.Exceptions.officeUIDynamicEventHandlingException("The directive 'dynamicEventHandling' could not be placed on an element without an id attribute.")}else{var a=OfficeUICore.SearchEvent("#"+e);if(a!=null){c.on(a.handler,function(){a.action()})}}}}});OfficeUIModule.directive("stopPropagation",function(){return{restrict:"A",link:function(c,b,a){b.bind(a.stopPropagation,function(d){d.stopPropagation()})}}});OfficeUIModule.filter("actionLegend",function(){return function(a){if(a.MenuItems){return a.Legend+' <i class="fa fa-caret-down"></i>'}return a.Legend}});