var OfficeUI=angular.module("OfficeUIApplication",["ngSanitize"]);OfficeUI.factory("OfficeUIConfigurationService",function(a){return{getOfficeUIConfiguration:function(){if(typeof $.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==="undefined"||$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation==""){OfficeUICore.Exceptions.officeUIConfigurationException("The OfficeUI Configuration file is not defined.")}return a.get($.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation).then(function(b){return{Styles:b.data.Styles,DefaultStyle:b.data.DefaultStyle,Themes:b.data.Themes,DefaultTheme:b.data.DefaultTheme,Configuration:b.data.Configuration,Controls:b.data.Controls}},function(b){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI Configuration file: '"+$.fn.OfficeUI.Settings.OfficeUIConfigurationFileLocation+"' could not be loaded.")})}}});OfficeUI.directive("officeuiApplication",function(){return{restrict:"AE",replace:true,templateUrl:"/Resources/Data/Templates/OfficeUI.html"}});OfficeUI.directive("officeuiToggleClassOnClick",function(){return{restrict:"A",link:function(d,c,a){var b=a.officeuiToggleClassOnClick;c.bind("mousedown mouseup",function(){c.toggleClass(b)});c.bind("mouseout",function(){if(c.hasClass(b)){c.removeClass(b)}})}}});OfficeUI.controller("OfficeUIController",function(c,a,d){a.isInitialized=false;a.loadingScreenLoaded=false;b();function b(){c.getOfficeUIConfiguration().then(function(g){var e=JSPath.apply('.{.name == "'+g.DefaultStyle+'"}',g.Styles);var f=JSPath.apply('.{.name == "'+g.DefaultTheme+'"}',g.Themes);a.Style=e[0].stylesheet;a.Theme=f[0].stylesheet;a.loadingScreenLoaded=true;d.get(g.Configuration).then(function(h){a.Title=h.data.Title;a.Icons=h.data.Icons},function(h){OfficeUICore.Exceptions.officeUILoadingException("The OfficeUI application definition file: '"+g.Configuration+"' could not be loaded.")})});setTimeout(function(){a.isInitialized=true;a.$apply()},2000)}});