$(function(){$("#OfficeUI a.button").on("mousedown mouseup",function(){$(this).toggleClass("active-ie-fix")});$.fn.OfficeUIMenu=function(){var next=function(selector){var $element=$(selector);return $element.children(":eq(0)").add($element.next()).add($element.parents().filter(function(){return $(this).next().length>0}).next()).first()};var previous=function(selector){var $element=$(selector);return $element.prev().find("*:last").add($element.parent()).add($element.prev()).last()};var element=$("li.has-children",this);var legend=$(".legend",element);$(legend).prepend('<i class="fa fa-caret-right"></i>');$(element).addClass("collapsed");$("i",this).click(function(e){var element=$(this).parent().parent().next();console.log(element);if($(this).hasClass("fa-caret-down")){$(this).removeClass("fa-caret-down").addClass("fa-caret-right");element.removeClass("animateShowChildren");element.addClass("animateHideChildren")}else{if($(this).hasClass("fa-caret-right")){$(this).removeClass("fa-caret-right").addClass("fa-caret-down");element.removeClass("animateHideChildren");element.addClass("animateShowChildren")}}});return this};$.fn.OfficeUIDropdown=function(){$.fn.selectedItem="";$(this).addClass("no-select");$(this).append('<i class="fa fa-sort-desc"></i>');var hasFocus=function(element){return element.hasClass("focus")};var isActive=function(element){return element.hasClass("active")};var isMenuOpened=function(element){return element.hasClass("opened")};$.fn.isMenuOpened=function(){return isMenuOpened($(this))};var Open=function(element){$(".elements",element).show("slide",{direction:"up"},100);$(element).addClass("opened").addClass("focus")};$.fn.Close=function(){$(".elements",this).hide();this.removeClass("opened");$(this).removeClass("focus")};this.hover(function(){$(this).addClass("focus")},function(){if(!$(this).is(":focus")&&!isMenuOpened($(this))){$(this).removeClass("focus")}});this.focusout(function(){$(this).removeClass("active").removeClass("focus")});$("i",this).click(function(e){var shouldClose=isMenuOpened($(this).parent());$("#OfficeUI .dropdown").each(function(index,item){if(isMenuOpened($(item))){$(item).Close()}});if(shouldClose){if(isMenuOpened($(this).parent())){$(this).parent().Close()}}else{Open($(this).parent())}e.stopPropagation()});$(".elements li",this).click(function(){var selectedLiText=$(this).html();$(".dropdown-legend",$(this).parent().parent()).html(selectedLiText);$.fn.selectedItem=selectedLiText;var attribute=$(this).parent().parent().attr("data-on-change");if(typeof attribute!=="undefined"&&attribute!=""){eval(attribute)}$(this).parent().parent().Close();$(this).removeClass("focus")});return this};$("#OfficeUI .dropdown").OfficeUIDropdown();$("#OfficeUI .dropdown").OfficeUIMenu();$("#OfficeUI .button").addClass("no-select");$(window).on("click",function(e){$("#OfficeUI .dropdown").each(function(index,item){if($(item).isMenuOpened()){$(item).Close()}})})});